##--
## gimmecov function
##
## Arguments:
## data:      (Optional) A vector with your row-wised written values 
##            including the diagonal. 
## cov.txt:   A .txt file with the values including the diagonal.
## nvars:     Number of variables 
## varnames:  (optional) A character string with the variable names
## names.txt: A .txt file including the variable names. (sep ="" as a
##            default, however you can change it)
## -- 

gimmecov <- function(data = NULL, cov.txt, 
                     nvars, 
                     varnames = NULL, names.txt, sep = ""){
  if (is.null(data)) mat <- scan(file = cov.txt)
  else mat <- data
  
  triangular <- function(s) sapply(1:s, function(x) sum(1:x))
  triangular(nvars)
  
  diagmat <- mat[triangular(nvars)]
  uppermat <- mat[-triangular(nvars)]
  
  testm <- matrix(NA, ncol = nvars, nrow = nvars, byrow = TRUE)
  testm[upper.tri(testm)] <- uppermat
  testm[lower.tri(testm)] <- t(testm)[lower.tri(testm)]
  diag(testm) <- diagmat
  
  if (is.null(varnames)) 
    tmpnames <- scan(names.txt, what = "character", sep = sep)
  else tmpnames <- varnames  

  dimnames(testm) <- list(tmpnames, tmpnames)
  
  return(testm)
}

## EXAMPLE
## setwd("/Users/tasospsy/Google Drive/_UvA/SEM/week3/Assignment2/")

## covmat <- gimmecov(cov.txt = "savacov.txt",
                   names.txt = "savanames.txt",
                   nvars = 6)

